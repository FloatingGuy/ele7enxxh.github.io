<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 为Android编译带-e选项的netcat · Ele7enxxh's Blog</title><meta name="description" content="为Android编译带-e选项的netcat - ele7enxxh"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="stylesheet" href="http://fonts.useso.com/css?family=Source+Sans+Pro:400,600" type="text/css"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://weibo.com/5545520757" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/ele7enxxh" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">为Android编译带-e选项的netcat</h1><div class="post-info">Mar 6, 2015</div><div class="post-content"><p>本文主要介绍了如何为Android编译带-e选项的netcat。<a id="more"></a></p>
<p>环境<br>OS：Ubuntu14.04 64</p>
<h2 id="编译busybox"><a href="#编译busybox" class="headerlink" title="编译busybox"></a>编译busybox</h2><p>首先到<a href="http://www.busybox.net/" target="_blank" rel="external">这里</a>下载busybox源码，这里我下载的版本为1.23.1。<br>搭建交叉编译环境：<br><code>apt-get install gcc-arm-linux-gnueabi libc-dev-armel-cross</code><br>在busybox目录下执行：<br><code>make menuconfig</code><br>进入图形选择模式，必填的选项为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Busybox Settings-&gt;General Configuration-&gt;</span><br><span class="line">[*]Don&apos;t use /usr</span><br><span class="line">Busybox Settings-&gt;Build Options-&gt;</span><br><span class="line">[*] Build BusyBox as a static binary (no shared libs)</span><br><span class="line">(arm-linux-gnueabi-) Cross Compiler prefix</span><br><span class="line">Networking Utilities-&gt;</span><br><span class="line">[*] Netcat 1.10 compatibility (+2.5k)</span><br></pre></td></tr></table></figure></p>
<p>保存设置退出menuconfig，执行：<br><code>make -j8</code><br>成功后会在当前目录生产busybox，通过busybox nc即可调用netcat。</p>
<h2 id="编译netcat"><a href="#编译netcat" class="headerlink" title="编译netcat"></a>编译netcat</h2><p>由于不能直接从busybox单独的提取出netcat命令，所以使用郑郭busybox稍显臃肿（strip版本大概为2m），所以我又决定直接对netcat源码进行交叉编译。<br>首先到<a href="http://netcat.sourceforge.net/" target="_blank" rel="external">这里</a>下载netcat源码这里我下载的版本是0.7.1。<br>这里可以采用两种编译手段：</p>
<ol>
<li>gnu编译<br>搭建交叉编译环境：<br><code>apt-get install gcc-arm-linux-gnueabi libc-dev-armel-cross</code><br>修改netcat目录src文件夹下的netcat.c文件，在首部添加两个宏：#define GAPING_SECURITY_HOLE，#define TELNET。<br>在netcat目录下执行：<br><code>./configure --host=arm-linux CC=arm-linux-gnueabi-gcc CFLAGS=&quot;-static -O2&quot;</code><br><code>--prefix= /home/auo/Temp/netcat-0.7.1/out</code><br>具体路径请自行修改。<br>成功后，执行：<br><code>make -j8</code><br>成功后继续执行：<br><code>make install</code><br>生成后的netcat在/home/auo/Temp/netcat-0.7.1/out/bin/目录下，最后执行：<br><code>arm-linux-gnueabi-strip -s &#39;/home/auo/Temp/netcat-0.7.1/out/bin/netcat&#39;</code><br>strip后netcat的大小为583.1kB。</li>
<li>NDK编译<br>修改netcat目录src文件夹下的netcat.c文件，在首部添加两个宏：#define GAPING_SECURITY_HOLE，#define TELNET。<br>在netcat目录下执行：<br><code>./configure --host=arm-linux CC=arm-linux-androideabi-gcc</code><br><code>CFLAGS=&quot;-static --sysroot=/home/auo/Android/android-ndk-r10d/platforms/android-21/arch-arm -O2&quot;</code><br><code>--prefix=/home/auo/Temp/netcat-0.7.1/out</code><br>具体路径请自行修改，环境变量自行添加。<br>成功后，执行：<br><code>make -j8</code><br>成功后继续执行：<br><code>make install</code><br>生成后的netcat在/home/auo/Temp/netcat-0.7.1/out/bin/目录下，最后执行：<br><code>arm-linux-androideabi-strip -s &#39;/home/auo/Temp/netcat-0.7.1/out/bin/netcat&#39;</code><br>strip后netcat的大小为326.1kB，显而易见，使用ndk编译出的netcat体积要减小很多。</li>
</ol>
</div></article></div></section><footer><div class="paginator"><a href="/Use-Ccache-To-Speed-Up-Android-Compilation.html" class="prev">PREV</a><a href="/AndroidManifest-Binary-Editor.html" class="next">NEXT</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'ele7enxxh';
var disqus_identifier = 'Compile-Netcat-For-Android.html';
var disqus_title = '为Android编译带-e选项的netcat';
var disqus_url = 'http://ele7enxxh.com/Compile-Netcat-For-Android.html';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//ele7enxxh.disqus.com/count.js" async></script><div class="copyright"><p>© 2015 - 2016 <a href="http://ele7enxxh.com">ele7enxxh</a>, unless otherwise noted.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-MML-AM_CHTML"></script><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "//hm.baidu.com/hm.js?e9925f9b47e12674b38b04ce3cde49e6";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></body></html>